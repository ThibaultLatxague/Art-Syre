@if(utilisateurCourant != null && utilisateurCourant.estAdmin) {
<mat-card class="header-card">
    <mat-card-header>
        <mat-icon mat-card-avatar class="header-icon">description</mat-icon>
        <mat-card-title>Gestion des Utilisateurs</mat-card-title>
        <mat-card-subtitle>Consultation et suivi des comptes utilisateur</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
        <p class="description">
            Consultez l'ensemble des comptes utilisateur inscrits sur la plateforme.
            Chaque utilisateur est caractérisé par des informations précises.
            Il est possible de supprimer et modifier un utilisateur.
        </p>

        <!-- Statistiques rapides -->
        <div class="stats-grid">
            <mat-card class="stat-card">
                <mat-icon>storage</mat-icon>
                <div class="stat-content">
                    <span class="stat-label">Nombre d'utilisateurs</span>
                    <span class="stat-value">{{ 0 }}</span>
                </div>
            </mat-card>

            <mat-card class="stat-card">
                <mat-icon>category</mat-icon>
                <div class="stat-content">
                    <span class="stat-label">Nombre d'administrateurs</span>
                    <span class="stat-value">{{ 0 }}</span>
                </div>
            </mat-card>

            <mat-card class="stat-card">
                <mat-icon>update</mat-icon>
                <div class="stat-content">
                    <span class="stat-label">Dernière mise à jour</span>
                    <span class="stat-value">{{ 0 }}</span>
                </div>
            </mat-card>
        </div>

        <!-- Fonctionnalités -->
        <mat-expansion-panel class="features-panel">
            <mat-expansion-panel-header>
                <mat-panel-title>
                    <mat-icon>info</mat-icon>
                    Fonctionnalités disponibles
                </mat-panel-title>
            </mat-expansion-panel-header>
            <ul class="features-list">
                <li>
                    <mat-icon>check_circle</mat-icon>
                    <span>Visualisation des utilisateurs en fonction de leurs informations (Nom, Prénom, Email, etc.)</span>
                </li>
                <li>
                    <mat-icon>check_circle</mat-icon>
                    <span>Modification d'un utilisateur</span>
                </li>
                <li>
                    <mat-icon>check_circle</mat-icon>
                    <span>Suppression d'un utilisateur</span>
                </li>
            </ul>
        </mat-expansion-panel>
    </mat-card-content>
</mat-card>

<div class="admin-users-container">
    <div class="admin-header">
        <h1>Administration des Utilisateurs</h1>
        <p class="subtitle">Gérez vos utilisateurs en toute simplicité</p>
    </div>

    <div class="users-panel">
        <div class="filter-section">
            <mat-form-field>
                <mat-label>Filtre</mat-label>
                <input matInput (keyup)="applyFilter($event)" placeholder="Ex. Rechercher un utilisateur..." #input>
            </mat-form-field>
        </div>

        <div class="mat-elevation-z8">
            <table mat-table [dataSource]="dataSource" matSort>

                <!-- ID Column -->
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> ID
                    </th>
                    <td mat-cell *matCellDef="let row">
                        <span class="id-badge">{{row.id}}</span>
                    </td>
                </ng-container>

                <!-- name Column - Correction du % -->
                <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Nom
                    </th>
                    <td mat-cell *matCellDef="let row">
                        <span class="name-cell">{{row.name}}</span>
                    </td>
                </ng-container>

                <!-- prenom Column -->
                <ng-container matColumnDef="prenom">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                        Prénom </th>
                    <td mat-cell *matCellDef="let row">
                        <span class="prenom-cell">{{row.prenom}}</span>
                    </td>
                </ng-container>

                <!-- email Column -->
                <ng-container matColumnDef="email">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Email
                    </th>
                    <td mat-cell *matCellDef="let row">
                        <span class="email-cell">{{row.email}}</span>
                    </td>
                </ng-container>

                <!-- dateCreation Column -->
                <ng-container matColumnDef="dateCreation">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Date
                        de création </th>
                    <td mat-cell *matCellDef="let row">
                        <span class="date-cell">{{row.dateCreation |
                            date:'dd/MM/yyyy'}}</span>
                    </td>
                </ng-container>

                <!-- estAdmin Column avec badge -->
                <ng-container matColumnDef="estAdmin">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                        Statut </th>
                    <td mat-cell *matCellDef="let row">
                        <span class="status-badge" [ngClass]="row.estAdmin === 1 ? 'admin' : 'user'">
                            {{row.estAdmin === 1 ? 'Admin' : 'Utilisateur'}}
                        </span>
                    </td>
                </ng-container>

                <!-- tableauLikes Column -->
                <ng-container matColumnDef="tableauxLikes">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                        Tableaux aimés </th>
                    <td mat-cell *matCellDef="let row">
                        <span class="count-badge likes">{{row.tableauxLikes}}</span>
                    </td>
                </ng-container>

                <!-- tableauxDansPanier Column -->
                <ng-container matColumnDef="tableauxDansPanier">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                        Panier </th>
                    <td mat-cell *matCellDef="let row">
                        <span class="count-badge cart">{{row.tableauxDansPanier}}</span>
                    </td>
                </ng-container>

                <!-- Actions Column -->
                <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef> Actions </th>
                    <td mat-cell *matCellDef="let row" class="actions-cell">
                        <button mat-button class="edit-btn" (click)="editUser(row)"
                            matTooltip="Modifier cet utilisateur">
                            <i class="material-icons">edit</i>
                            Modifier
                        </button>
                        <button mat-button class="delete-btn" (click)="confirmDelete(row)"
                            matTooltip="Supprimer cet utilisateur">
                            <i class="material-icons">delete</i>
                            Supprimer
                        </button>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

                <!-- Row shown when there is no matching data. -->
                <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" [attr.colspan]="displayedColumns.length">
                        Aucune donnée ne correspond au filtre "{{input.value}}"
                    </td>
                </tr>
            </table>

            <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" [pageSize]="10" showFirstLastButtons
                aria-label="Sélecteur de taille de page">
            </mat-paginator>
        </div>
    </div>
</div>
} @else {
<div class="empty-state">
    <p>Vous n'avez pas les droits nécessaires pour accéder à cette section.</p>
</div>
}