<div class="admin-users-container">
    <div class="admin-header">
        <h1>Administration des Utilisateurs</h1>
        <p class="subtitle">Gérez vos utilisateurs en toute simplicité</p>
    </div>

    <div class="users-panel">
        <div class="filter-section">
            <mat-form-field>
                <mat-label>Filtre</mat-label>
                <input matInput (keyup)="applyFilter($event)"
                    placeholder="Ex. Rechercher un utilisateur..." #input>
            </mat-form-field>
        </div>
        
        <div class="mat-elevation-z8">
            <table mat-table [dataSource]="dataSource" matSort>

                <!-- ID Column -->
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> ID </th>
                    <td mat-cell *matCellDef="let row"> 
                        <span class="id-badge">{{row.id}}</span>
                    </td>
                </ng-container>

                <!-- name Column - Correction du % -->
                <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Nom </th>
                    <td mat-cell *matCellDef="let row"> 
                        <span class="name-cell">{{row.name}}</span>
                    </td>
                </ng-container>

                <!-- prenom Column -->
                <ng-container matColumnDef="prenom">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Prénom </th>
                    <td mat-cell *matCellDef="let row"> 
                        <span class="prenom-cell">{{row.prenom}}</span>
                    </td>
                </ng-container>

                <!-- email Column -->
                <ng-container matColumnDef="email">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Email </th>
                    <td mat-cell *matCellDef="let row"> 
                        <span class="email-cell">{{row.email}}</span>
                    </td>
                </ng-container>

                <!-- dateCreation Column -->
                <ng-container matColumnDef="dateCreation">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Date de création </th>
                    <td mat-cell *matCellDef="let row"> 
                        <span class="date-cell">{{row.dateCreation | date:'dd/MM/yyyy'}}</span>
                    </td>
                </ng-container>

                <!-- estAdmin Column avec badge -->
                <ng-container matColumnDef="estAdmin">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Statut </th>
                    <td mat-cell *matCellDef="let row"> 
                        <span class="status-badge" [ngClass]="row.estAdmin === 1 ? 'admin' : 'user'">
                            {{row.estAdmin === 1 ? 'Admin' : 'Utilisateur'}}
                        </span>
                    </td>
                </ng-container>

                <!-- tableauLikes Column -->
                <ng-container matColumnDef="tableauxLikes">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Tableaux aimés </th>
                    <td mat-cell *matCellDef="let row"> 
                        <span class="count-badge likes">{{row.tableauxLikes}}</span>
                    </td>
                </ng-container>

                <!-- tableauxDansPanier Column -->
                <ng-container matColumnDef="tableauxDansPanier">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Panier </th>
                    <td mat-cell *matCellDef="let row"> 
                        <span class="count-badge cart">{{row.tableauxDansPanier}}</span>
                    </td>
                </ng-container>

                <!-- Actions Column -->
                <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef> Actions </th>
                    <td mat-cell *matCellDef="let row" class="actions-cell">
                        <button mat-button class="edit-btn" (click)="editUser(row)"
                            matTooltip="Modifier cet utilisateur">
                            <i class="material-icons">edit</i>
                            Modifier
                        </button>
                        <button mat-button class="delete-btn" (click)="deleteUser(row.id)"
                            matTooltip="Supprimer cet utilisateur">
                            <i class="material-icons">delete</i>
                            Supprimer
                        </button>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

                <!-- Row shown when there is no matching data. -->
                <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" [attr.colspan]="displayedColumns.length">
                        Aucune donnée ne correspond au filtre "{{input.value}}"
                    </td>
                </tr>
            </table>

            <mat-paginator 
                [pageSizeOptions]="[5, 10, 25, 100]"
                [pageSize]="10"
                showFirstLastButtons
                aria-label="Sélecteur de taille de page">
            </mat-paginator>
        </div>
    </div>
</div>